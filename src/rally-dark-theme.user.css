/* ==UserStyle==
@name           Rally Dark Theme
@namespace      USO Archive
@author         steeltomato
@description    `Dark Theme for CA Technologies' Rally AgileThis theme is a work-in-progress for the new Rally theme based on Bootstrap`
@version        20200910.19.53
@license        CC0-1.0
@preprocessor   uso
==/UserStyle== */
@-moz-document domain("rallydev.com") {

    /* Global */
    :root {
        --main-background-color: #111;
        --main-color: #ddd;
        --main-border-color: #555;
        --link-color: #3eb9f8;

        --content-background-color: #112;

        --panel-background-color: #223;
        --panel-color: #bbb;

        --control-background-color: #444;
        --control-border-color: #777;
        --control-color: #bbb;
        --control-text-shadow-color: #44444480;

        --text-input-background-color: var(--control-background-color);
        --text-input-border-color: var(--control-border-color);
        --text-input-color: var(--control-color);

        --cke-editable-background-color: #1e1e1e;
        --cke-editable-color: #dcdcdc;

        --smb-panel-header-background-color: #111;

        --smb-table-header-cell-background-color: #1f1f29;
        --smb-table-header-cell-border-bottom-color: #555;
        --smb-table-header-cell-color: #bbb;

        --smb-table-cell-border-top-color: #112;
        /* var(--main-background-color); */

        --smb-data-table-background-color: var(--smb-table-header-cell-background-color);
        /* var(--main-background-color); */

        --title-color: #ddd;


        --alm-border-color: #444;

        --alm-button-background-color: #1f1f29;
        --alm-button-border-color: #555;
        --alm-button-color: #bbb;

        --button-background-color: #292929;
        --button-border-color: #555;
        --button-disabled-background-color: var(--hover-background-color);

        --navbar-section-color: #aaa;
        --navbar-section-selected-background-color: #223;

        --active-background-color: #2929c4;
        --active-color: #ddd;
        --hover-background-color: #50509F;
        --hover-border-color: #494991;
        --hover-color: var(--active-color);
        --selected-background-color: #4B4B85;
        --selected-color: var(--active-color);

        --viewport-button-background-color: #223;
    }

    body,
    #main {
        border-color: var(--main-border-color);
        background-color: var(--main-background-color);
        color: var(--main-color);
    }

    #main a {
        color: var(--link-color);
    }

    /* HACK: Workaround for hardcoded inline CSS for black */
    font[style^="color:#000000"],
    span[style^="color:#000000"],
    font[style^="color:black"],
    span[style^="color:black"] {
        color: inherit !important;
    }

    #main #content {
        background-color: var(--main-background-color);
    }

    #main #content .page {
        background-color: var(--content-background-color);
    }

    ::-webkit-scrollbar {
        width: 1em;
    }

    ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
    }

    ::-webkit-scrollbar-thumb {
        background-color: darkgrey;
        outline: 1px solid slategrey;
    }

    /* Header */
    .alm-header-container {
        background-color: var(--content-background-color);
        border-bottom-color: var(--alm-border-color);
    }

    .alm-header-container .header-util .smb-Button--iconOnly:not(.chr-ViewportProfileMenu-dropdown):not(.smb-TextInput-clearButton) {
        background-color: var(--alm-button-background-color);
        border-color: var(--alm-button-border-color);
        color: var(--alm-button-color);
    }

    #main .chr-NavBar .chr-NavSection,
    #main .chr-NavBar-alt .chr-NavSection,
    #main .project-picker .project-nav-container .project-nav-label {
        color: var(--navbar-section-color);
    }

    #main .chr-NavBar .chr-NavSection.is-selected>div:first-child,
    #main .chr-NavBar-alt .chr-NavSection.is-selected>div:first-child,
    #main .chr-NavBar .chr-NavSection.is-selected,
    #main .chr-NavBar-alt .chr-NavSection.is-selected {
        background-color: var(--navbar-section-selected-background-color);
        color: var(--link-color);
    }

    #main .chr-NavBar .chr-NavSection:hover,
    #main .chr-NavBar-alt .chr-NavSection:hover {
        background-color: var(--active-background-color);
    }

    #main .chr-NavDropMenu {
        background-color: var(--content-background-color);
    }

    /* Nav */
    #main .chr-NavDropMenu .chr-NavDropMenu-item .chr-NavDropMenu-itemContent>span {
        color: var(--main-color);
    }

    /* Viewport */

    #main .chr-WorkspacePicker-listContainer,
    #main .chr-ViewportProjectPickerTray,
    #main .chr-ViewportRecentProjects,
    #main .chr-ViewportScopeUpDown {
        background-color: var(--content-background-color);
    }

    #main .chr-ViewportProjectPickerTreeItem:hover {
        background-color: var(--hover-background-color);
    }

    #main .chr-ViewportProjectPickerTreeItem--current {
        background-color: var(--selected-background-color);
    }

    #main .chr-ViewportProjectPickerTray a,
    #main .chr-WorkspacePicker-listItem .chr-WorkspacePicker-workspaceLink {
        color: var(--main-color);
    }

    .chr-ViewportProjectPickerHierarchy .chr-ViewportProjectPickerHierarchy-header>.smb-Button,
    .chr-ViewportProjectPickerHierarchy .chr-ViewportProjectPickerHierarchy-header>.chr-ViewportProjectPickerHierarchy-search>.smb-Button {
        background-color: var(--viewport-button-background-color);
    }

    .chr-WorkspacePicker-listItem.chr-WorkspacePicker-listItem--active {
        background-color: var(--selected-background-color);

    }

    /* Stats */

    #main .chr-StatsBanner-panels,
    #main .chr-StatsBanner-toggle,
    #main .chr-StatsBannerProgressPanel,
    #main .chr-StatsBannerItemCountPanel,
    #main .chr-StatsBanner-launchChartsPanel {
        background-color: #223;
        border-color: #000;
    }

    #main .chr-StatsBannerProgressPanel-title,
    #main .chr-StatsBannerItemCountPanel-title {
        color: #aaa;
    }

    /* Footer */
    #main .chr-Footer {
        background-color: var(--content-background-color);
        color: #aaa;
    }

    /* Main Area */
    #main .chr-Page,
    #main .chr-PlanTeamPage,
    #main .chr-BacklogPage,
    #main .chr-ToolbarDefaultToolbar {
        background-color: var(--main-background-color);
    }

    #main .chr-PlanTeamPage>.smb-Header {
        border-bottom: 1px solid #444;
    }

    #main .chr-PlanTeamPage .chr-PlanTeamPage-columnDivider {
        background-color: #444;
    }

    #main .smb-HeaderGroup-title {
        color: #aaa;
    }

    #main .chr-PlanTeamPage .chr-PlanTeamBacklog .smb-PanelHeader .smb-HeaderGroup-title,
    #main .chr-PlanTeamPage .chr-PlanTeamIterationsPanel .smb-PanelHeader .smb-HeaderGroup-title {
        color: #999;
    }

    #main .chr-Tray {
        background-color: #223;
        border-color: #444;
    }

    #main .smb-Panel {
        border-bottom-color: var(--main-border-color);
    }

    #main .smb-PanelHeader {
        /* color: #ddd; */
        /* TODO what uses this */
        background-color: var(--smb-panel-header-background-color);
        border-bottom-color: var(--main-border-color);
    }

    #main .chr-FullDetailOverlay {
        background-color: var(--main-background-color);
    }

    #main .chr-FullDetailPage {
        /* color: #ddd; */
        /* REDUNDANT */
        border-color: #555 !important;
    }

    /* Tables */
    #main .smb-DataTable,
    #main .smb-TableCell,
    #main .chr-PlanTeamBacklog .chr-PlanTeamBacklogDataTable-grouped>.smb-DataTable-wrapper>.smb-DataTable>.smb-TableBody>.smb-TableRow,
    #main .smb-TableRow,
    #main .smb-Pagination,
    #main .chr-PlanTeamIterationsDataTable .smb-TableRowDragDropWrapper.is-groupByRow,
    #main .chr-RollupRow-cell {
        color: var(--smb-table-header-cell-color);
        background-color: var(--smb-data-table-background-color);
    }

    #main .smb-DataTableTableHeaderCellDragLayer,
    #main .smb-TableHeaderCell {
        background-color: var(--smb-table-header-cell-background-color);
        border-bottom-color: var(--smb-table-header-cell-border-bottom-color);
        color: var(--smb-table-header-cell-color);
    }

    #main .smb-DataTableTableHeaderCellDragLayer .smb-DataTableTableHeaderCellDragLayer-content .smb-TableHeaderCell-sortIcon,
    #main .smb-DataTableTableHeaderCellDragLayer .smb-TableHeaderCell-content .smb-TableHeaderCell-sortIcon,
    #main .smb-TableHeaderCell .smb-DataTableTableHeaderCellDragLayer-content .smb-TableHeaderCell-sortIcon,
    #main .smb-TableHeaderCell .smb-TableHeaderCell-content .smb-TableHeaderCell-sortIcon,
    #main .smb-TableHeaderCell .smb-TableHeaderCell-sort .smb-TableHeaderCell-sortIcon,
    #main .smb-TableCell.smb-TableCell--rowActions,
    #main .chr-PlanTeamIterationsPanel .smb-PanelBody>.smb-DataTable-wrapper>.smb-DataTable tbody tr.is-groupByRow>td,
    #main .chr-PlanTeamIterationsPanel .smb-PanelBody>.smb-DataTable-wrapper>.smb-DataTable tbody tr.is-groupByRow>th {
        background-color: var(--smb-table-header-cell-background-color);
    }

    #main .smb-SvgIcon--gear,
    #main .smb-SvgIcon--help,
    #main .smb-SvgIcon--feedback {
        color: #999;
    }

    #main .smb-DataTable:not(.personalized-nav) .smb-Cutline:first-child .smb-TableCell,
    #main .smb-DataTable:not(.personalized-nav) .smb-TableRow:not(.is-groupByRow):first-child .smb-TableCell,
    #main .smb-TableCell,
    #main .chr-PlanTeamIterationsDataTable .smb-TableRowDragDropWrapper.is-groupByRow .smb-TableCell {
        border-top-color: var(--content-background-color);
    }

    #main .chr-PlanTeamIterationsPanel .smb-PanelBody>.smb-DataTable-wrapper>.smb-DataTable>thead th,
    #main .chr-PlanTeamIterationsDataTable>thead .smb-TableHeaderCell .smb-TableHeaderCell-content {
        background-color: #335;
        color: #ddd;
    }

    #main .smb-DataTableTableHeaderCellDragLayer .smb-TableHeaderCell-colResizer,
    #main .smb-TableHeaderCell .smb-TableHeaderCell-colResizer,
    #main .smb-DataTableTableHeaderCellDragLayer.is-resizing .smb-TableHeaderCell-colResizer,
    #main .smb-TableHeaderCell.is-resizing .smb-TableHeaderCell-colResizer {
        background-color: #555;
    }

    #main .smb-DataTableTableHeaderCellDragLayer.is-resizing,
    #main .smb-TableHeaderCell.is-resizing {
        background-color: #445;
    }

    #main .smb-ChildPager-displayText {
        color: #ddd;
        margin-right: 10px;
    }

    #main .smb-DataTableBlankSlate-primaryMessage,
    #main .no-data-container .primary-message {
        color: #ddd;
    }

    #main .smb-DataTableBlankSlate-secondaryMessage,
    #main .no-data-container .secondary-message {
        color: #aaa;
    }

    /* New Item Side Panel */
    .smb-ResizableDrawer {
        color: #ddd !important;
        background-color: #111 !important;
    }

    .smb-ResizableDrawer-draggableLeft {
        background-color: #222 !important;
    }


    #main .smb-TextInput {
        color: var(--text-input-color);
        background-color: var(--text-input-background-color);
        border-color: var(--text-input-border-color);
    }

    #main .smb-TextInput input {
        color: inherit;
    }

    /* Team Board */
    #main .chr-BoardRow {
        background-color: var(--main-background-color);
    }

    #main .chr-BoardWithToolbar-wrapper .chr-BoardWithToolbar-column,
    #main .chr-BoardWithToolbar-wrapper .chr-BoardWithToolbar-columnHeader,
    #main .chr-TeamBoardSettingsColumn {
        background-color: #223;
    }

    #main .chr-BoardTitle {
        color: #ddd !important;
    }

    #main .chr-BoardWipLimit {
        color: #aaa !important;
    }

    #main .chr-BoardCard {
        background-color: var(--content-background-color);
        box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.4), 0 0 0 1px #555;
    }

    #main .smb-FieldLabel-text,
    #main .chr-BoardField {
        color: #ddd;
    }

    #main .chr-RenderersUser .chr-RenderersUser-ownedBy {
        color: #ccc;
    }

    #main .chr-RenderersUser .chr-RenderersUser-name {
        color: #aaa;
    }

    /* Story Page */
    #main .chr-QuickDetailEntityHeader .chr-QuickDetailFormattedId-panelTitle {
        color: #ddd;
    }

    /* Discussion Page */
    #main .chr-DiscussionsPostTile-post,
    #main .chr-DiscussionsPostTile-arrow,
    #main .chr-DiscussionsPostTile-arrow::after,
    #main .discussion-richtext-stream-view {
        background-color: #111;
    }

    #main .discussion-richtext-stream-view .list .list-item {
        color: #bbb;
    }

    #main .chr-DiscussionsPostTile-text {
        color: #bbb;
    }

    /* SMB Button */
    #main .smb-Button {
        border-color: var(--button-border-color);
    }

    #main .smb-Button--icon,
    #main .smb-Button--link,
    #main .smb-Button--minimal {
        background-color: transparent;
        border-color: transparent;
        color: var(--link-color);
    }

    #main .smb-ButtonGroup>.smb-Button,
    #main .smb-ButtonGroup .smb-PopoverTrigger .smb-Button {
        background-color: var(--button-background-color);
        border-color: var(--button-border-color);
    }

    #main .smb-Button.is-disabled,
    #main .smb-Button[disabled],
    #main .smb-Button[disabled]:active,
    #main .smb-Button[disabled]:focus,
    #main .smb-Button[disabled]:hover {
        background-color: var(--button-disabled-background-color);
    }

    #main .smb-Button--icon:not(.is-disabled):hover,
    #main .smb-Button--link:not(.is-disabled):hover,
    #main .smb-Button--minimal:not(.is-disabled):hover {
        background-color: var(--main-background-color);
        border-color: var(--main-background-color);
        color: var(--link-color);
    }

    #main .smb-Button--icon:not(.is-disabled):active,
    #main .smb-Button--link:not(.is-disabled):active,
    #main .smb-Button--minimal:not(.is-disabled):active {
        background-color: var(--active-background-color);
        /* technically not... */
    }

    #main .smb-Button--success,
    #main .smb-Button--failure,
    #main .smb-Button--secondary,
    #main .chr-FilterButton--numFilters {
        color: #ddd !important;
        /* fixes hover */
        background-color: #444 !important;
    }

    #main .smb-Button--success.is-active {
        background-color: #005700 !important;
    }

    #main .smb-Button--failure.is-active {
        background-color: #790000 !important;
    }

    #main .smb-Button.is-disabled {
        background-color: #292929 !important;
    }

    /*
    .smb-DropdownHeader,
    .smb-DropdownHeader-text,
    .smb-Select-text,
    .smb-DropdownItem,
    .smb-DropdownItem-text {
        color: #ddd !important;
    }
*/

    #main .smb-Dropdown.smb-Select .smb-SvgIcon {
        color: var(--link-color);
    }

    #main .smb-Dropdown .smb-Select-trigger {
        background-color: var(--control-background-color);
        border-color: var(--control-border-color);
        color: var(--control-color);
    }

    #main .smb-Dropdown.smb-Select:not(.is-disabled):not(.is-readOnly).is-open .smb-Select-trigger {
        background-color: var(--control-background-color);
        border-color: var(--control-border-color);
    }

    #main .smb-DropdownList-list.is-mouseMode .smb-DropdownItem:not(.is-disabled):hover {
        background-color: var(--hover-background-color);
    }

    #main .smb-DropdownList-list.is-mouseMode .smb-DropdownItem:not(.is-disabled):hover .smb-DropdownItem-text,
    #main .smb-DropdownList-list.is-mouseMode .smb-DropdownItem:not(.is-disabled):hover .smb-DropdownItem-subtext {
        color: var(--hover-color);
    }

    #main .smb-DropdownList-listContentWrapper {
        background-color: var(--control-background-color);
        border-color: var(--control-border-color);
        color: var(--control-color);
    }

    #main .smb-DropdownList-footer {
        background-color: var(--panel-background-color);
        color: var(--panel-color);
    }

    #main .smb-DropdownItem {
        background-color: var(--control-background-color);
        border-color: var(--control-border-color);
        color: var(--control-color);
    }

    #main .smb-DropdownItem.is-active {
        background-color: var(--active-background-color);
        color: var(--active-color);
    }

    #main .smb-DropdownItem.is-active:not(.is-disabled) {
        background-color: var(--active-background-color);
    }

    #main .smb-DropdownItem.is-active:not(.is-disabled) .smb-DropdownItem-text,
    #main .smb-DropdownItem.is-active:not(.is-disabled) .smb-DropdownItem-subtext {
        color: var(--active-color);
    }

    #main .smb-DropdownItem.is-selected {
        background-color: var(--selected-background-color);
    }

    #main .smb-DropdownItem-subtext {
        color: var(--title-color);
    }

    #main .smb-DropdownHeader {
        color: var(--control-color);
    }

    #main .smb-Select-subtext {
        color: var(--title-color);
    }

    /* SMB Popover */
    #main .smb-Popover,
    #main .smb-Popover>.smb-Popover-arrow,
    #main .smb-Popover>.smb-Popover-arrow::after,
    #main .smb-PopoverContent {
        background-color: var(--panel-background-color);
    }

    #main .smb-Popover-header .smb-Popover-title {
        color: var(--title-color);
    }

    /* CHR Saved Views */

    #main .chr-SavedViewsCollectionsDataTable-title,
    #main .chr-SavedViewsSelect-label {
        color: var(--title-color);
    }

    #main .chr-SavedViewsSelect .smb-DropdownList-footer {
        background-color: var(--panel-background-color);
    }

    #main .chr-EditorsWorkItemEditor,
    #main .chr-EditorsMultiItemEditor {
        color: #bbb !important;
        background-color: #444 !important;
        border-color: #555 !important;
    }

    #main .smb-CapacityBar {
        background-color: #444;
    }

    #main .chr-TableCellStateBlocks-stateBlock--before {
        background-color: #447;
    }

    #main .chr-TableCellStateBlocks-stateBlock--after {
        color: #ddd;
        background-color: #444;
    }

    #main .chr-TableCellStateBlocks-stateBlock--current {
        color: #ddd;
        background-color: #2929c4;
    }

    #main .chr-TableCellStateBlocks-stateBlock--current.is-blocked {
        background-color: #c00;
    }

    #main .is-disabled.smb-TextArea,
    #main [disabled].smb-TextArea {
        color: #444;
    }

    /* Text Editor */

    /* CKE's rules are... ugh. */
    .cke_reset_all {
        background-color: var(--main-background-color);
        border-color: var(--main-border-color);
        color: var(--main-color);
    }

    .cke_reset_all *,
    .cke_reset_all a,
    .cke_reset_all textarea {
        background-color: var(--main-background-color);
        border-color: var(--main-border-color);
        color: var(--main-color);
    }

    /* Text Editor : Toolbar -- icons limit what we can do here... */
    .cke_top {
        background-color: var(--control-color);
        border-color: var(--control-border-color);
        color: var(--control-background-color);
    }
    /* have to '*' and 'a' because cke_reset_all does */
    .cke_top div,
    .cke_top span,
    .cke_top a {
        background-color: inherit;
        border-color: inherit;
        color: var(--control-background-color);
    }

    .cke_combo_text {
        /* seems broken */
        margin-bottom: 0;
    }

    .cke_wysiwyg_frame,
    .cke_wysiwyg_div {
        background-color: #bbb !important;
    }

    .cke_combo_off a.cke_combo_button:hover,
    .cke_combo_off a.cke_combo_button:focus,
    .cke_toolgroup a.cke_button_off:hover,
    .cke_toolgroup a.cke_button_on:hover {
        background-color: var(--hover-background-color);
        border-color: var(--hover-border-color);
        color: var(--hover-color);
    }

    .cke_top .cke_toolbox .cke_combo_text:hover,
    .cke_top .cke_toolbox .cke_combo_off a.cke_combo_button:hover,
    .cke_top .cke_toolbox .cke_combo_off a.cke_combo_button:focus,
    .cke_top .cke_toolbox .cke_toolgroup a.cke_button_off:hover,
    .cke_top .cke_toolbox .cke_toolgroup a.cke_button_on:hover {
        background-color: var(--hover-color);
        border-color: var(--hover-border-color);
        color: var(--hover-background-color);
    }

    .cke_toolbox .cke_combo_off a.cke_combo_button:hover,
    .cke_toolbox .cke_combo_off a.cke_combo_button:focus,
    .cke_toolbox .cke_combo_off a.cke_combo_button:active {
        border-color: var(--link-color);
    }

    .cke_combo_text {
        color: var(--control-color);
        text-shadow: 0 1px 0 var(--control-text-shadow-color);
    }

    /* Make the CKE font panel match the editor. */
    .cke_panel_container {
        background-color: var(--cke-editable-background-color);
        color: var(--cke-editable-color);
    }

    .cke_panel_grouptitle {
        border-color: var(--control-border-color);
        color: var(--control-color);
        text-shadow: 0 1px 0 var(--control-text-shadow-color);
    }

    .cke_panel_listItem a {
        border-color: var(--cke-editable-background-color);
    }

    .cke_panel_listItem a:hover {
        background-color: var(--hover-background-color);
        border-color: var(--hover-border-color);
    }

    .cke_panel_listItem a:focus,
    .cke_panel_listItem a:active {
        background-color: var(--active-background-color);
        border-color: var(--cke-editable-background-color);
        color: var(--active-color);
    }

}

@-moz-document domain("rallydev.com") {

    h2 .chr-QuickDetailAttributeEditorWrapper-label,
    h3 .chr-QuickDetailAttributeEditorWrapper-label,
    .project-picker .project-nav-button,
    .smb-HeaderTitle {
        color: hsl(218.2, 11.1%, 65.2%);
    }

    /* ExtJS 4 */

    /* .x4-body class is on body, in main.
     * Following rule is for any *nested* .x4-body elements (unlikely but not impossible).
     */

    #main .x4-body {
        color: var(--main-color);
    }

    #main .x4-btn

    /*,#main .smb-ButtonGroup .smb-PopoverTrigger .smb-Button*/
        {
        background-color: var(--button-background-color);
        border-color: #555;
    }

    #main .x4-grid-body {
        background-color: inherit;
        color: inherit;
    }

    #main .x4-form-field,
    #main .x4-form-field input {
        background-color: #555 !important;
        color: #ddd !important;
    }

    #main .x4-form-trigger {
        color: #ddd;
        background-color: #555;
    }

    #main .x4-field-label-cell,
    #main .page-size-label {
        color: #ddd;
    }

    #main .x4-column-header {
        color: #ddd;
        background-color: #333;
        border-color: #333;
    }

    #main .x4-column-header .x4-column-header-inner {
        color: #ddd;
    }

    #main .x4-grid-cell {
        background-color: #111;
        color: #ddd;
        border-color: #555;
    }


    /* Text Editor */
    .smb-RichTextEditor-textArea,
    .cke_editable {
        background-color: var(--cke-editable-background-color);
        color: var(--cke-editable-color);
    }

    .smb-Button--icon,
    .chr-FormattedId .chr-FormattedId-idText,
    .cke_editable a {
        color: var(--link-color);
    }

    .cke_bottom {
        background-color: #bbb;
    }

    /* Images so they don't POP white (they'll still be white because they are.) */
    .style_4 {
        background-color: #000;
    }

    /* Select State (P/I/D) */

    .chr-EditorsScheduleStateEditor .smb-Select-text {
        color: transparent !important;
    }

    .chr-EditorsScheduleStates-block--before {
        background-color: hsl(216.8, 93%, 63.1%);
    }

    .chr-EditorsScheduleStates-block--after {
        background-color: hsl(217.5, 30.8%, 69.8%);
    }

    .chr-QuickDetailQuickDetailEditor .smb-DropdownItem:not(.is-active):not(.is-selected):not(.is-disabled):not(:hover) .smb-DropdownItem-text,
    .chr-QuickDetailQuickDetailEditor .smb-Select:not(.is-disabled) .smb-Select-text {
        color: var(--control-color);
    }
}
